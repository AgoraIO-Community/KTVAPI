# 虚拟声卡集成说明

### 一、集成步骤

#### 1、将AudioSettings文件拷贝进项目, 并修改 package

#### 2、创建 AudioSettings 模块

* 创建 RtcEngine 实例

~~~
val mRtcEngine = RtcEngine.create()
~~~

* 创建 AudioSettings 实例

~~~
// 将mRtcEngine传给AudioSettigs
val audioSettings = AudioSettigs(mRtcEngine)
~~~

#### 3、调用 API: enableVirtualSoundCard 控制虚拟声卡的开关和选择

~~~
fun enableVirtualSoundCard(sceneType: SceneType, soundCardType: SoundCardType, earPhoneType: EarPhoneType?)
~~~

* sceneType: 场景类型, 分为 K 歌房和语聊房, 在不同场景下需要使用对应的 type
* soundCardType: 虚拟声卡类型, close 为关闭
* earPhoneType: 插入耳机的类型, null 为默认

##### 例子

* 关闭虚拟声卡

~~~
audioSettings.enableVirtualSoundCard(SceneType.KTV, SoundCardType.Close, null)
~~~

* 在语聊场景下开**男生磁性**音效

~~~
audioSettings.enableVirtualSoundCard(SceneType.Chat, SoundCardType.NanShengCiXing, null)
~~~

* 在 k 歌场景下开**女生唱歌**音效, 且耳机选择**针对华为系列有线耳机**

~~~
audioSettings.enableVirtualSoundCard(SceneType.KTV, SoundCardType.NvShengChangGe, EarPhoneType.EQ3)
~~~

#### 4、获取当前虚拟声卡开关状态

enabled 为静态成员变量

~~~
val enabled = AudioSettings.enabled
~~~

#### 5、重置虚拟声卡状态

在RtcEngine释放前需要手动关闭虚拟声卡, 避免状态错误

* 关闭虚拟声卡

~~~
audioSettings.enableVirtualSoundCard(SceneType.KTV, SoundCardType.Close, null)
~~~

* 释放 RtcEngine

~~~
RtcEngine.destroy()
~~~



### 二、类型介绍

#### 1、场景类型

* KTV: K歌房
* ChatRoom: 语聊房

~~~
enum class SceneType(val value: Int) {
    KTV(0),
    ChatRoom(1)
}
~~~

#### 2、虚拟声卡类型

* NanShengCiXing 男生磁性
*  NvShengCiXing 女生磁性
*  NanShengTianMei 男生甜美 延迟大(60ms) 男声甜美在k歌场景下会被映射到男生唱歌
*  NvShengTianMei 女生甜美 延迟大(60ms) 女生甜美在k歌场景下会被映射到女生唱歌
*  NanShengChangGe 男生唱歌
*  NvShengChangGe 女生唱歌
*  Close 关

~~~
enum class SoundCardType constructor(
    val gainValue: Float,
    val presetValue: Int,
    val gender: Int,
    val effect: Int,
) {
    NanShengCiXing(gainValue = 1.0f, presetValue = 4, gender = 0, effect = 0),
    NvShengCiXing(gainValue = 1.0f, presetValue = 4, gender = 1, effect = 0),
    NanShengTianMei(gainValue = 1.0f, presetValue = 4, gender = 0, effect = 1),
    NvShengTianMei(gainValue = 1.0f, presetValue = 4, gender = 1, effect = 1),
    NanShengChangGe(gainValue = 1.0f, presetValue = 4, gender = 0, effect = 2),
    NvShengChangGe(gainValue = 1.0f, presetValue = 4, gender = 1, effect = 2),
    Close(gainValue = -1.0f, presetValue = -1, gender = -1, effect = -1)
}
~~~

#### 3、插入耳机的类型

 *  EQ0 针对小米系列有线耳机
 *  EQ1 针对Sony系列有线耳机
 *  EQ2 针对JBL系列有线耳机
 *  EQ3 针对华为系列有线耳机
 *  EQ4 针对iphone系列有线耳机(默认)

```
enum class EarPhoneType constructor(val presetValue: Int) {
    EQ0(0),
    EQ1(1),
    EQ2(2),
    EQ3(3),
    EQ4(4),
}
```
